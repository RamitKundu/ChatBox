app.controller('JobController', [
		'JobService',
		'$http',
		'$scope',
		'$location',
		'$rootScope',
		function(JobService, $http, $scope, $location, $rootScope) {

			var self = this;
			self.job = {};
			self.jobapp = {};
			self.joblist = [];
			// self.qual={};
			// For posting jobs

			self.createJob = function() {

				console.log("Job controller called");

				JobService.addJob(self.job).then(function() {
					// self.job = response.data;
					// $cookieStore.put('currentUser',self.responsedata);
					alert("Job Posted successfully..:)");
					$location.path("/alljobs");

				}, function(error) {
					console.log(error);
				});
			}

			self.postJob = function() {
				self.createJob();
			}

			// For All Jobs

			self.getJobList = function() {

				console.log("JobList controller called");
				JobService.listJob().then(function(response) {
					self.joblist = response.data;
					console.log(self.joblist);

				}, function(error) {
					console.log(error);
				});
			}
			//self.getJobList();

			// For Applied jobs
			self.applyJob = function(j) {

				console.log("JobApply controller called");
				console.log(j);
				var data = {

					user : $rootScope.currentUser,
					job : j,

				}

				JobService.addJobapply(data).then(function(response) {
					alert("Job Applied Successfully..:)");
					$location.path("/allappliedjobs");

				}, function(error) {
					console.log(error);
				});
			}

			self.getMyJobList = function() {

				console.log("My JobList controller called");
				JobService.listmyJob($rootScope.currentUser.userId).then(
						function(response) {
							self.joblists = response.data;
							console.log("B4 routing:"+self.joblists);
							$location.path("/allmyjobs");
							console.log("Aftr routing:"+self.joblists);

						}, function(error) {
							console.log(error);
						});
			}

			// self.getMyJobList();

			self.getAppliedJobListAdmin = function() {
				console.log("Applied Jobs for Admin called");
				JobService.listAppliedJobsAdmin().then(function(response) {
					self.joblist = response.data;
					console.log(self.joblist);
					$location.path("/appliedjobsadmin");

				}, function(error) {
					console.log(error);
				});

			}
		} ])
